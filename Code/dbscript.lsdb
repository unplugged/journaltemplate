<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE note SYSTEM 'xmlschemas/domino_8_5_3.dtd'>
<note class='filter' xmlns='http://www.lotus.com/dxl' version='8.5' maintenanceversion='3.0'
 replicaid='85257AD8004C0F2E'>
<noteinfo noteid='21a' unid='F57FE875112E8ACF852573C6005D9E97' sequence='5'>
<created><datetime>20080104T120234,47-05</datetime></created>
<modified><datetime>20121218T085047,89-05</datetime></modified>
<revised><datetime dst='true'>20090924T132616,44-04</datetime></revised>
<lastaccessed><datetime>20121218T085047,89-05</datetime></lastaccessed>
<addedtofile><datetime>20121218T085047,89-05</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name></updatedby>
<revisions><datetime>20080104T120258,91-05</datetime></revisions>
<wassignedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name></wassignedby>
<item name='$DBScript' summary='false' sign='true'><text>'++LotusScript Development Environment:2:5:(Options):0:74
Option Declare
'++LotusScript Development Environment:2:5:(Forward):0:1
Declare Sub RemoveDocs(source As NotesUIDatabase,dc As notesDocumentcollection)
Declare Sub Querydocumentdelete(Source As Notesuidatabase, Continue As Variant)

'++LotusScript Development Environment:2:5:(Declarations):0:10
'[Translation Begin]
Const DocPreviewTitle = "Delete"
Const DocPreviewMessage = |The document could not be deleted because you currently have the same document open in the Preview Pane.  
This open document will be closed so it can be deleted from the current view.|
'[Translation End]

'++LotusScript Development Environment:2:2:BindEvents:1:129
Private Sub BindEvents(Byval Objectname_ As String)
	Static Source As NOTESUIDATABASE
	Set Source = Bind(Objectname_)
	On Event Querydocumentdelete From Source Call Querydocumentdelete
End Sub

'++LotusScript Development Environment:2:2:RemoveDocs:1:8
Sub RemoveDocs(source As NotesUIDatabase,dc As notesDocumentcollection)
	
	On Error Goto Errorroutine
	
	Dim ws As New notesuiworkspace
	Dim note As NotesDocument
	Dim notePlaceHolder As NotesDocument
	Dim noteid As String
	
	If Not(dc Is Nothing) Then
		Set note = dc.GetFirstdocument
	Else
' If collection document from view is nothing then probably a document is opened
		Set note = ws.currentdocument.document
		If Not(note Is Nothing) Then			
			Set notePlaceHolder = note
			If notePlaceHolder.IsUIDocOpen Then
				noteid = notePlaceHolder.noteid
				Delete notePlaceHolder			
				Set notePlaceHolder = ws.CurrentDatabase.database.getdocumentbyid(noteid)
				notePlaceHolder.remove(True)
				Exit Sub
			End If
		End If
	End If
	
'Documents selected in a view with or without Preview pane... 
	While Not (note Is Nothing)
		Set notePlaceHolder = note
		Set note = dc.getnextdocument(note)
		If notePlaceHolder.IsUIDocOpen Then
			noteid = notePlaceHolder.noteid
			Delete notePlaceHolder			
			Set notePlaceHolder = ws.CurrentDatabase.database.getdocumentbyid(noteid)
			notePlaceHolder.remove(True)
			Call ws.viewrefresh
		Else
			notePlaceHolder.remove( True)
			Call ws.viewrefresh
		End If		
	Wend	
	
	Exit Sub	
	
ErrorRoutine:
	If Err = 4241 Then
		Messagebox DocPreviewMessage, 48, DocPreviewTitle
		Exit Sub
	End If
	
	Exit Sub
	
End Sub
'++LotusScript Development Environment:2:2:Querydocumentdelete:1:12
Sub Querydocumentdelete(Source As Notesuidatabase, Continue As Variant)
	On Error Goto ErrorTrap
	
	Dim ws As New notesuiworkspace
	Dim uiview As NotesUIView
	Dim uidoc As NotesUIDocument
	Dim collection As NotesDocumentCollection
	Dim doc As NotesDocument
	
	Dim strViewName As String
	Dim e As Variant
	Dim SoftDelEnabled As Integer
	
	Set uiview = ws.currentview
	
	If Not(uiview Is Nothing) Then
		strViewName=uiview.ViewAlias
		Set collection = source.documents
	End If
	
	'is softdeletes enabled...
	SoftDelEnabled = False
	e =  Evaluate( "@IsSoftDeleteEnabled")
	If Isarray(e) Then
		If e(0) = 1 Then
			SoftDelEnabled = True			
		End If
	End If	
	
	If SoftDelEnabled = True Then
		Call RemoveDocs(source, collection)
		continue = False
		Call ws.ViewRefresh
		Exit Sub
	End If
	
ErrorTrap:
	If Cstr(Err) &lt;&gt; "0" Then Print (Cstr(Err) &amp; " " &amp; Error$)
	Exit Sub
End Sub<break/></text></item>
<item name='$DBScript_O' summary='false' sign='true'>
<rawitemdata type='500'>
AQAAAkxTT0IDABQIZW4AAAQANQCCAgQAEABECiAHAAAAAAAAnAHwBgAAAAAAAMAAGAA4ADQDtAJU
AAAAAAAAAAUAAAAIAIgFAAAAACgAKAA4AjgCiAWIBQAAAAAAAAAACAAIAAAAAAAAAAAAAAAAAAAA
AAAAAAAASABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAcAAAD8APAGwAPwBgAAAACoAfACAAAAAIQEhAQAAAAAUAZQBgAAAAAAAAAA
AAAAAPwA/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAEABQBMb3R1cyBQcm9kdWN0AAAAVjAuMAAAAAAAAAAAAAAAAAAA
AAAEAAAAggIAAAAAAABECgAAIAcAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAA
AAYAAABXMzJJIQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAwAkBwAAAAAkAAgAKgA2AEMAMQAzAEMAMQA0AAAAAABsAAMATgBFAFcAAACAAAYARABFAEwA
RQBUAEUAAAAAAKgACgBJAE4ASQBUAEkAQQBMAEkAWgBFAAAAAAD4AAkAVABFAFIATQBJAE4AQQBU
AEUAAADQAgYATwBCAEoARQBDAFQAAAAAAIgAAAAAAAAAnAAGAFMATwBVAFIAQwBFAAAAAADkAAIA
RABDAAAAAACEAwgAQwBPAE4AVABJAE4AVQBFAAAAAACYAg8ARABPAEMAUABSAEUAVgBJAEUAVwBU
AEkAVABMAEUAAAB0BAYARABlAGwAZQB0AGUAAAAAACABEQBEAE8AQwBQAFIARQBWAEkARQBXAE0A
RQBTAFMAQQBHAEUAAAAIA7gAVABoAGUAIABkAG8AYwB1AG0AZQBuAHQAIABjAG8AdQBsAGQAIABu
AG8AdAAgAGIAZQAgAGQAZQBsAGUAdABlAGQAIABiAGUAYwBhAHUAcwBlACAAeQBvAHUAIABjAHUA
cgByAGUAbgB0AGwAeQAgAGgAYQB2AGUAIAB0AGgAZQAgAHMAYQBtAGUAIABkAG8AYwB1AG0AZQBu
AHQAIABvAHAAZQBuACAAaQBuACAAdABoAGUAIABQAHIAZQB2AGkAZQB3ACAAUABhAG4AZQAuACAA
IAAKAFQAaABpAHMAIABvAHAAZQBuACAAZABvAGMAdQBtAGUAbgB0ACAAdwBpAGwAbAAgAGIAZQAg
AGMAbABvAHMAZQBkACAAcwBvACAAaQB0ACAAYwBhAG4AIABiAGUAIABkAGUAbABlAHQAZQBkACAA
ZgByAG8AbQAgAHQAaABlACAAYwB1AHIAcgBlAG4AdAAgAHYAaQBlAHcALgAAAAAAuAMKAEIASQBO
AEQARQBWAEUATgBUAFMAAAAAAMQDCwBPAEIASgBFAEMAVABOAEEATQBFAF8AAAD0Ag8ATgBPAFQA
RQBTAFUASQBEAEEAVABBAEIAQQBTAEUAAADIBgYAJQBMAFMAWABVAEkAAAAAAPwDEwBRAFUARQBS
AFkARABPAEMAVQBNAEUATgBUAEQARQBMAEUAVABFAAAAUAMKAFIARQBNAE8AVgBFAEQATwBDAFMA
AAAAANgEFwBOAE8AVABFAFMARABPAEMAVQBNAEUATgBUAEMATwBMAEwARQBDAFQASQBPAE4AAACY
AwYAJQBMAFMAWABCAEUAAAAAAKgFDABFAFIAUgBPAFIAUgBPAFUAVABJAE4ARQAAAAAAVAUCAFcA
UwAAAAAA7AMQAE4ATwBUAEUAUwBVAEkAVwBPAFIASwBTAFAAQQBDAEUAAAAAAGAEBABOAE8AVABF
AAAAAAAcBA0ATgBPAFQARQBTAEQATwBDAFUATQBFAE4AVAAAADwEDQBOAE8AVABFAFMARABBAFQA
QQBCAEEAUwBFAAAAaAUPAE4ATwBUAEUAUABMAEEAQwBFAEgATwBMAEQARQBSAAAAnAQGAE4ATwBU
AEUASQBEAAAAAAAwBRAARwBFAFQARgBJAFIAUwBUAEQATwBDAFUATQBFAE4AVAAAAAAAwAQPAEMA
VQBSAFIARQBOAFQARABPAEMAVQBNAEUATgBUAAAAwAUIAEQATwBDAFUATQBFAE4AVAAAAAAA9AQL
AEkAUwBVAEkARABPAEMATwBQAEUATgAAABgFDwBDAFUAUgBSAEUATgBUAEQAQQBUAEEAQgBBAFMA
RQAAAIwFCABEAEEAVABBAEIAQQBTAEUAAAAAAEwGDwBHAEUAVABEAE8AQwBVAE0ARQBOAFQAQgBZ
AEkARAAAAP//BgBSAEUATQBPAFYARQAAAAAA1AUPAEcARQBUAE4ARQBYAFQARABPAEMAVQBNAEUA
TgBUAAAAGAcLAFYASQBFAFcAUgBFAEYAUgBFAFMASAAAAAAGCQBFAFIAUgBPAFIAVABSAEEAUAAA
AHAGBgBVAEkAVgBJAEUAVwAAAAAA8AULAE4ATwBUAEUAUwBVAEkAVgBJAEUAVwAAACQGBQBVAEkA
RABPAEMAAACwBg8ATgBPAFQARQBTAFUASQBEAE8AQwBVAE0ARQBOAFQAAABABgoAQwBPAEwATABF
AEMAVABJAE8ATgAAAAAAaAYDAEQATwBDAAAA//8LAFMAVABSAFYASQBFAFcATgBBAE0ARQAAAJQG
AQBFAAAA//8OAFMATwBGAFQARABFAEwARQBOAEEAQgBMAEUARAAAAAAAEAcLAEMAVQBSAFIARQBO
AFQAVgBJAEUAVwAAAOAGCQBWAEkARQBXAEEATABJAEEAUwAAAP//CQBEAE8AQwBVAE0ARQBOAFQA
UwAAAP//FABAAEkAcwBTAG8AZgB0AEQAZQBsAGUAdABlAEUAbgBhAGIAbABlAGQAAAAAAP//AQAw
AAAA//8BACAAAAAFAEgKAAAAAFl5DQgZABkABAAAACgAAADEAAYAAAAAAOgAAAAAAAAAAAAAAAAA
AAAEAAAASAAAAPwABgAAAAAAJAEAAAAAAAAAAAAAAAAAAAgAAAA4AgAAnAIAAAAAAAACAAAA4ACM
AQAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAACMAYwBAAAAAAAAAAABAAAA
AgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAwABAIwBAAC4AgYIAAAAABoAAAD4Av//AAAAABAAAACoAQAA1AIAAAAA
AAACAAAA7AgYCgAAAAAYChgKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7AjsCAAAAAAAAAAAAAAA
AAAAAAADFRMp7S5pEL9dAN0BEYa3AAAAAAAAAAAAAAAAAAAAAGQAAAAQLHBhAAAAAAAAAAACAPAA
AADwBwAAAAAKAAEA//8AAAMAIAAAAAAAjAAJAgAA/AAaAPAAiAP//wAAAAAQAAAA8ALwAlQDAAAA
AAAAAgAAAAgIcAkAAAAAcAlwCQAAAAAAAAAAAAAAAAAAAAAAAAAACAgICAAAAAAAAAAAAAAAAAAA
AAAAAAAACxQTKe0uaRC/XQDdARGGtwAAAAAAAAAAAAAAAAAAAABkAAAAMC0gYwAAAAAAAAAAAgCc
AQAAAAD8AAAAAgABAP//AAAIAAAAiAUAADgDAAAAAAAABgAAANACaAVoBWgFAAAAAAAAAAAAAAAA
WAVYBQAAAACwA0gFAAAAAOAC4AIAAAAA0ALQAgAAAAAAAAAAAgAAAAsAAAAhAAAAIAAAAAEAAAB4
BXgFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHgFeAUAAAAAAAAAAAAAAAAAAAAAAAAAAAMA
AQDgAgAAjAAJAgAA/AADAAEAsAMAAKAACQIBAKgBEAAAAMADAADIAwAAAAAAAAQAAAA4CNAJAAAA
ADgIOAgAAAAAAAAAAAAAAACkCaQJ0AnQCQAAAAAAAAAAAAAAAAAAAADICMgIAAAAAAIVEyntLmkQ
v10A3QERhrcAAAAAAAAAAAAAAAAAAAAAZAAAABAscGEAAAAAAAAAAAIA8ACAAwAAqAEAAAoAAQD/
/wAAEgAUAAAAAAD//wkCAAAAAAAGAAAAAPAC8AD//wAAAAAEAAEAAAAJAvACCQLwAhkAAwACAEgF
SAW8AwkCEADwAhAABACEBPAGAAQAAAAAAAADAAAAgAhACaQIpAgAAAAAAAAAAAAAAABACUAJAAAA
AAAAAAAAAAAAAAAAAIAIgAgAAAAAAAAAAAAAAAAEFBMp7S5pEL9dAN0BEYa3LhQTKe0uaRC/XQDd
ARGGt2QAAAAwLSBjAAAAAAAAAAACAJwBUAQAAIQEAAACAAEA//8AABIAFAAAAAAA//8JAgAAAACN
BAAAAADAA5wB//8AAAAABgACAAAACQLAAwkCwAMJAoQEGQAQAAAAUAYAACAEAAAAAAAAAQAAABAJ
EAkAAAAAAAAAAAAAAAAAAAAAEAkQCQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhQT
Ke0uaRC/XQDdARGGtwAAAAAAAAAAAAAAAAAAAABkAAAAMC0gYwAAAAAAAAAAAgCcARQFAADwAgAA
AgABAP//AAASABQAAAAAAP//CQIAAAAAEgQAAAAAhAScAf//AAAAAAYAAwAAAAkChAQJAoQEBggG
CBkAAwACAFgFAADwAwkCFADAAwMAAgBoBQAAQAQJAhgAwAMDAAIAAAAAAGQEBgAcAAAADQAIAAAA
AACcAwAAdgEZAAgAAAAAAAAADAMAAAAAAAAKAAAAIAbQBwAAAAAAAAAAAAAAAAAAAADgBsAHAAAA
AEAGoAcwBoAH0AfQBwAAAAAgBrAHAAAAAAAAAAACAAAACgAAAKIBAAA6AAAAAQAAAOAH4AcAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AfgBwAAAAAAAAAAAwABADAGsAeM
AAkCAAD8AAMAAQBABoAHrAAAAAEAAAADAAIA4AagB7wDCQIQAPACEAAAAPAGAADYBQAAAAAAAAEA
AAD0CfQJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD0CfQJAAAA
AAYVEyntLmkQv10A3QERhrcAAAAAAAAAAAAAAAAAAAAAZAAAABAscGEAAAAAAAAAAAIA8AAAAAAA
wAMAAAoAAQD//wAAAwACAIAHkAfEBQkCFABQBhAAAAAAAAAABAYAAAAAAAABAAAAXAhcCAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXAhcCAAAAAAEFRMp7S5pEL9d
AN0BEYa3AAAAAAAAAAAAAAAAAAAAAGQAAAAQLHBhAAAAAAAAAAACAPAAAAAAAFAGAAAKAAEA//8A
AAMAAgCQBwAA9AUJAhgA8AYDAAIAoAfABygGCQIcAKgBAwACALAHAABEBgkCIADAAwMAAgDABwAA
UAYGACQAAAADAAIA0AcAAGwGAAAoAAAAAwACAAAAAAB0BgEAOAAAAA0ACAAAAAAArAUAAGECGQAT
AAAADAMAANwAAAABAAAAAQAAAAAAAAASABQAcAkAAHgECYIAAAAANgUAAAAAqAGcAf//AAAAAAQA
AQAAAAkCwAMJAqgBGQARABAFyAgAAKAECQLiBQAAAAAAAAAAAAAAAAAAAAAAAAAA8AYRABAFAAAA
AMQECQKoBgAAAAAAAAAAAAAAAAAAAAAAAAAAwAMRABAFpAgAANwEAACHCwAAAAAAAAAAAAAAAAAA
AAAAAAAAAAARABAFQAkAAGQEBgB8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARABAFpAkAAPgECQLk
BQAAAAAAAAAAAAAAAAAAAAAAAAAA/AARABAFGAoAABwFCQIbBgAAAAAAAAAAAAAAAAAAAAAAAAAA
hAQSABQAAAAAADQFCYIAAAAADQQAAAAAhAScAf//AAAAAAUAAgAAAAkCwAMJAoQEBggSABQAAAAA
AFgFAQAAAAAAkwQAAAAAwAOcAf//AAAAAAQAAgAAAAEACQLAAwEIGQASABQAAAAAAGwFCYIAAAAA
OAUAAAAAqAGcAf//AAAAAAYAAgAAAAkCwAMJAqgBCQrAAxkAEgAUANAJAACQBQoAAAAAAAIGAAAA
APAC8AD//wAAAAADAAEAAAAKAAkC8AIRABAFAAAAAJgGCQLjBQAAAAAAAAAAAAAAAAAAAAAAAAAA
UAYRABAEAAAAALQGJggfBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAARABAFAAAAAMwGCQIcBgAAAAAA
AAAAAAAAAAAAAAAAAAAAqAEUAAAAEAAACgQAhgIAAAAAHQAAGhEAW4wBSeAAyvwAphoSAEeMAcvc
AAAAiAUaEwAdGhgACwAAAAAJOkkBGhoAXrADK/ACJKYaHwBJ4AKBxaA4FAAaIABeSAVL4AIsCAgj
phohADp8ABojAF5IBUuwAy04CCMtXAgjphokAEpIBYHFoDhYABolAF5YBUpIBaYaJgBLWAUtgAgj
OD4AGicAXmgFS1gFLaQII6UaKABeWAXRGikAXlgFS7ADLcgIIy3sCCMsEAlKaAUjphoqAEtYBSxA
CYQjMRorABwaLAAaLQAaLgAaMQAbSkgFgcWgOJEAGjIAXlgFSkgFphozAF5IBUvgAixwCUpIBSOm
GjQAS1gFLYAIIzhKABo1AF5oBUtYBS2kCCOlGjYAXlgF0Ro3AF5YBUuwAy3ICCMt7AgjLBAJSmgF
I6YaOABLWAUsQAmEIzEaOQBLsAMspAkjGjoAOhkAGjsAS1gFLEAJhCMxGjwAS7ADLKQJIxo9ABo+
ADpl/xpAABwaQgAaQwAUkJEQsjgTABpEAH0kAZuOMH3oAJsGBxpFABwaRgAaSAAcGkoAHRpNAAsA
AAAACTqzABpPAF5ABivwAiSmGlkAXuAGS0AGLdAJI6YaWwBK4AaBxaA4HAAaXABesAdL4AYt9Akj
pRpdAF6QB0sgBi0YCiOmGl4AGmEAYgI4AIWnAhpiAF7AB4DUPAqlGmMAXsAHBhs4GgAaZACFZcAH
AYa4OAoAGmUAYgI4AISnAhpmABpnABppAFgCOACEsjgjABpqACk4Al0gBl6QByMaawBdMAaDpRps
AEtABiykCSMabQAcGm4AGnAAGnEAFJt9FAe1OAoAFJt9HAe/Fr8/ARpyABwacwAdBwAUAAAAAAAQ
AAoABAAAAAoA+wBLAQMAAgAAABEAHAAAAAAA//8BAAMAAwAAAAcAnAIOADgDFQAMA0sACgAAAA==
</rawitemdata></item>
<item name='$TITLE' sign='true'><text>Database Script</text></item>
<item name='$Flags'><text>t34Q</text></item>
<item name='$PublicAccess' sign='true'><text>1</text></item>
<item name='$LANGUAGE' sign='true'><text>en</text></item></note>

